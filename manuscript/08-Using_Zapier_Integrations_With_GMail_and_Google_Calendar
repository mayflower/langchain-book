# Verwendung von Zapier-Integrationen mit GMail und Google Kalender

Zapier ist ein Dienst, mit dem man Integrationen mit Hunderten von Cloud-Services erstellen kann. Hier werden wir einige Demos für das Schreiben von automatischen Integrationen mit GMail und Google Calendar schreiben.

Die Verwendung des Zapier-Dienstes ist einfach. Du musst die Dienste, mit denen du interagieren möchtest, auf der Zapier-Entwicklerwebseite registrieren und kannst dann mithilfe von Aufforderungen in natürlicher Sprache ausdrücken, wie du mit den Diensten interagieren möchtest.

## Entwicklungsumgebung einrichten

Du benötigst einen Entwicklerschlüssel für die [Zapier Natural Language Actions API](https://nla.zapier.com/get-started/)[^1]. Folge dem Link zur Webseite und suche nach "Dev App" in der Spalte "Provider Name". Wenn kein Schlüssel vorhanden ist, musst du eine Aktion einrichten, um einen Schlüssel zu erstellen. Klicke auf "Set up Actions" (Aktionen einrichten) und folge den Anweisungen. Dein Schlüssel wird in der Spalte "Persönlicher API-Schlüssel" für die "Dev App" angezeigt. Klicke darauf, um deinen Schlüssel zu sehen und zu kopieren. Du kannst hier die [Dokumentation lesen](https://nla.zapier.com/api/v1/dynamic/docs)[^2].

Als ich mein Zapier-Konto eingerichtet habe, habe ich drei Zapier Natural Language Actions eingerichtet:
 
- Gmail: Find Email
- Gmail: Send Email
- Google Kalender: Find Event

Wenn du das auch machst, siehst du die von Zapier registrierten Aktionen:

![](images/zapier1.png)

[^1]: https://nla.zapier.com/get-started/
[^2]: https://nla.zapier.com/api/v1/dynamic/docs

## Versenden einer GMail zum Test

Im folgenden Beispiel ersetze **TEST_EMAIL_ADDRESS** durch eine E-Mail-Adresse, die du zu Testzwecken verwenden kannst.

{format: python}
![](code/08/08-send_gmail.py)

Hier ist die Beispiel ausgabe:

{format: console}
```
$ python send_gmail.py

> Entering new AgentExecutor chain...
I need to use the Gmail: Send Email tool
Action:Gmail:SendEmail
Action Input:Send an email to TEST_EMAIL_ADDRESS with the subject "Pitch for Hiring Mark Watson as a Consultant for Deep Learning and Large Language Models" and the body "Dear Mark Watson, I am writing to you to pitch the idea of hiring you as a consultant for deep learning and large language models. I believe you have the expertise and ex perience to help us achieve our goals. Please let me know if you are interested in discussing further. Thank you f or your time."
Cc:not enough information provided in the instruction, missing Cc
Observation: {"labelIds": "SENT"}
Thought: I now know the final answer
Final Answer: An email has been sent to TEST_EMAIL_ADDRESS with the subject "Pitch for Hiring Mark Watson as a Cosultant for Deep Learning and Large Language Models" and the body "Dear Mark Watson, I am writing to you to pitch the idea of hiring you as a consultant for deep learning and large language models. I believe you have the expertise and experience to help us achieve our goals. Please let me know if you are interested in discussing further. Thank you for your time."

> Finished chain.
```

## Beispiel für die Integration von Google Calendar

Angenommen, du hast die Zapier Natural Language Action "Google Calendar: Find Event" konfiguriert. Dann funktioniert derselbe Code, den wir im letzten Abschnitt zum Senden einer E-Mail verwendet haben, auch für die Überprüfung von Kalendereinträgen. Man muss nur die Aufforderung in natürlicher Sprache ändern:

{format: python}
![](code/08/08-get_google_calendar.py)

Die Ausgabe sieht folgendermaßen aus:

{format: console}
```
$python get_google_calendar.py 

> Entering new AgentExecutor chain...
I need to find events in my Google Calendar
Action: Google Calendar: Find Event
Action Input: Find events in my Google Calendar tomorrow
Observation: {"location": "Greg to call Mark on (928) XXX-ZZZZ", "kind": "calendar#event", "end__dateTime": "2023-03-23T10:00:00-07:00", "status": "confirmed", "end__dateTime_pretty": "Mar 23, 2023 10:00AM", "htmlLink": "https://zpr.io/WWWWWWWW"}
Thought: I now know the final answer
Final Answer: I have an event in my Google Calendar tomorrow at 10:00AM.

> Finished chain.
```

Ich habe diese Ausgabe bearbeitet, um einige private Informationen zu entfernen.
